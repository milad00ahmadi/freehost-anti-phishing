import GmailValidator from './GmailValidator';
test('alerts that the gmail login page is fake', () => {
  const gmailValidator = new GmailValidator();
  document.body.innerHTML = `
   <div jscontroller="YmeC5c" jsaction="click:jKoJid(preventDefault=true|DPJEMd),rYhRle(preventDefault=true|RTjbJ);JIbuQc:WZ2Bje(Cuz2Ue);wMghFb:WWkjY;eyyw5c:QeZGZ;u3KAb:UHZ0U;ckUk1:s57X0c;CINcEf:IjS5bf;sPvj8e:XyQaue;rcuQ6b:WYd;EJh3N:.CLIENT;WMmLoc:.CLIENT;ms5v1:.CLIENT" jsname="nUpftc" data-locale="en" data-allow-sign-up-types="true"><div class="DRS7Fe bxPAYd k6Zj8d" jsname="bN97Pc" jscontroller="Z3Buzf" jsshadow="" data-branding="jcJzye" role="presentation"><div jsname="paFcre"><content><div class="jXeDnc" jsname="tJHJj" jscontroller="S9352b" jsaction="JIbuQc:pKJJqe(af8ijd);" jsshadow=""><h1 data-a11y-title-piece="" id="headingText"><content>Sign in</content></h1><div class="Y4dIwd" data-a11y-title-piece="" id="headingSubtext"><content>with your Google Account</content></div></div></content></div><div jsname="uybdVe" class="pwWryf bxPAYd" role="presentation"><div jsname="USBQqe" class="Wxwduf Us7fWe JhUD8d" role="presentation"><div class="WEQkZc"><div jscontroller="mjtijb" jsname="rEuO1b" data-form-action-uri=""><form method="post" novalidate=""><content><div jscontroller="mOzJ1b" jsaction="keydown:C9BaXe;O22p3e:Op2ZO;AHmuwe:Jt1EX;rcuQ6b:rcuQ6b;YqO5N:Lg5SV;EJh3N:rcuQ6b;sPvj8e:di0fJ;" jsname="dWPKW" class="cDSmF" data-allow-at-sign="true" role="presentation" jsshadow="" data-is-rendered="true"><div class="rFrNMe KSczvd uyaebd vHVGub zKHdkd sdJrJc Tyc9J" jscontroller="pxq3x" jsaction="clickonly:KjsqPd; focus:Jt1EX; blur:fpfTEe; input:Lg5SV;" jsshadow="" jsname="Vsb5Ub"><div class="aCsJod oJeWuf"><div class="aXBtI Wic03c"><div class="Xb9hP"><input class="whsOnd zHQkBf" jsname="YPqjbf" name="Email" autocomplete="username" spellcheck="false" tabindex="0" aria-label="Email or phone" autocapitalize="none" id="identifierId" dir="ltr" data-initial-dir="ltr" data-initial-value="" type="email"><div jsname="YRMmle" class="AxOyFc snByac" aria-hidden="true">Email or phone</div></div><div class="i9lrp mIZh1c"></div><div jsname="XmnwAc" class="OabDMe cXrdqd Y2Zypf" style="transform-origin: 51px 50% 0px;"></div></div></div><div class="LXRPh"><div jsname="ty6ygf" class="ovnfwe Is7Fhb"></div><div jsname="B34EJ" class="dEOOab RxsGPe" aria-atomic="true" aria-live="assertive"></div></div></div></div><div class="ck6P8" jsname="OZNMeb" aria-live="assertive"></div><div class="ck6P8"><div class="vI53Cf" jsname="Cuz2Ue" jscontroller="mLyKz" jsaction="JIbuQc:pqfr3d;"><input role="button" class="O0WRkf oG5Srb HQ8yf C0oVfc nDKKZc NpwL8d BqR4se" jscontroller="VXdfxd" jsaction="click:cOuCgd; mousedown:UX7yZ; mouseup:lbsD7e; mouseenter:tfO1Yc; mouseleave:JywGue;touchstart:p6p2H; touchmove:FwuNnf; touchend:yfqBxc(preventMouseEvents=true|preventDefault=true); touchcancel:JMtRjd;focus:AHmuwe; blur:O22p3e; contextmenu:mg9Pef;" jsshadow="" aria-disabled="false" tabindex="0" type="hidden"><span style="color: #4285f4;cursor: pointer;text-align: left;vertical-align: top;z-index: 0;display: inline-block;direction: ltr;text-transform: none;overflow: hidden;position: relative;left:-7px;font-weight: 400" onclick="window.location.href='https://accounts.google.com/signin/v2/usernamerecovery?passive=1209600&amp;continue=https%3A%2F%2Faccounts.google.com%2FManageAccount&amp;followup=https%3A%2F%2Faccounts.google.com%2FManageAccount&amp;flowName=GlifWebSignIn&amp;flowEntry=ServiceLogin'" class="RveJvd snByac">Forgot email?</span></div></div><input name="hiddenPassword" class="VwCw" tabindex="-1" aria-hidden="true" spellcheck="false" jsname="RHeR4d" type="password"><div jscontroller="T3edRd" jsname="Si5T8b" class="T8zd8e R43Xif" jsaction="click:IMdg8d(A1U4Sb);rcuQ6b:jqIVcd"><img jsname="O9Milc" id="captchaimg"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAQAAABLCVATAAABK0lEQVR4Ae2VA4wecRBHX23bisugjOtGjc3abezUto0YdU/hOTrb6pmxPmMyZy7O95a//yRvPYvNjFHIfTaAdXz4cPONpZjiWqtIpyaOmtH4UNjCR1yi8nLZuEZFyibS8Ml02qjGR3umESKjLvYY0/joyGSiZDyfKUY0PjqzmAapXDGiaRX9Zh4op6VSzoS+a1pFPtKYCcIkqqW2nw74epgU2X8PymPJT8yK3KzQdFhyvFmRj1OaVkqqNS96pGmSJOcQEJ2059KcLNN0xNrNfgXKU8mPzb2QiUwHYTK1Uttn5hP5wWxQzkmljPHWPtqlNEnlorU2MpU4Gc9lspXGNoMIfX47rLTabWSq/rj55r+Vr7hF4uGcHb+jeo5gBW35H1mMRfK5zVrGMIkf4fYw3QYeh94AAAAASUVORK5CYII=" jsname="A1U4Sb" id="playCaptchaButton" class="gIn9Gc" alt="Listen and type the numbers you hear" role="button" tabindex="0"><audio jsname="CakGX" type="audio/wav" id="captchaAudio"></audio><div jscontroller="XWIjRd" jsaction="keydown:C9BaXe;O22p3e:Op2ZO;AHmuwe:Jt1EX;rcuQ6b:rcuQ6b;YqO5N:Lg5SV;EJh3N:rcuQ6b;" jsname="CQRbLd" class="cDSmF" role="presentation" jsshadow="" data-is-rendered="true"><div class="rFrNMe KSczvd uyaebd zKHdkd sdJrJc Tyc9J" jscontroller="pxq3x" jsaction="clickonly:KjsqPd; focus:Jt1EX; blur:fpfTEe; input:Lg5SV;" jsshadow="" jsname="Vsb5Ub"><div class="aCsJod oJeWuf"><div class="aXBtI Wic03c"><div class="Xb9hP"><input class="whsOnd zHQkBf" jsname="YPqjbf" autocomplete="off" spellcheck="false" tabindex="0" aria-label="Type the text you hear or see" name="ca" id="ca" dir="ltr" data-initial-dir="ltr" data-initial-value="" type="text"><div jsname="YRMmle" class="AxOyFc snByac" aria-hidden="true">Type the text you hear or see</div></div><div class="i9lrp mIZh1c"></div><div jsname="XmnwAc" class="OabDMe cXrdqd"></div></div></div><div class="LXRPh"><div jsname="ty6ygf" class="ovnfwe Is7Fhb"></div><div jsname="B34EJ" class="dEOOab RxsGPe" aria-atomic="true" aria-live="assertive"></div></div></div></div><input jsname="SBlSod" name="ct" id="ct" type="hidden"></div></content></form></div><content><div class="vwtvsf"><div class="ck6P8">Not your computer? Use a Private Window to sign in. <div class="vI53Cf" jsname="JFyozc" jscontroller="mLyKz" jsaction="JIbuQc:pqfr3d;"><div role="presentation" class="O0WRkf oG5Srb HQ8yf C0oVfc nDKKZc NpwL8d BqR4se" jscontroller="VXdfxd" jsaction="click:cOuCgd; mousedown:UX7yZ; mouseup:lbsD7e; mouseenter:tfO1Yc; mouseleave:JywGue;focus:AHmuwe; blur:O22p3e; contextmenu:mg9Pef;" jsshadow="" aria-disabled="false"><a class="FKF6mc TpQm9d" href="https://support.google.com/accounts?p=signin_privatebrowsing&amp;hl=en"><div class="Vwe4Vb MbhUzd" jsname="ksKsZd"></div><div class="ZFr60d CeoRYc"></div><content class="CwaK9"><span class="RveJvd snByac">Learn more</span></content></a></div></div></div></div></content></div><div class="zQJV3" jsname="DH6Rkf" jscontroller="QEg9te" jsaction="rcuQ6b:rcuQ6b;JIbuQc:EXKDBe(bool6b),vjx2Ld(Njthtb),ChoyC(eBSUOb),mzsPGd(bCkDte),VaKChb(gVmDzc),JGhSzd;LEpEAf:dE26Sc(lqvTlf);waUZoe:xOhEZ;kvwKjc:Jn3Dic;h4C2te:JGhSzd;" data-skip-action-id="identifierSkip" data-primary-action-id="identifierNext"><div class="qhFLie"><input role="button" type="hidden" id="identifierNext" class="O0WRkf oG5Srb HQ8yf C0oVfc nDKKZc DL0QTb" jscontroller="VXdfxd" jsaction="click:cOuCgd; mousedown:UX7yZ; mouseup:lbsD7e; mouseenter:tfO1Yc; mouseleave:JywGue;touchstart:p6p2H; touchmove:FwuNnf; touchend:yfqBxc(preventMouseEvents=true|preventDefault=true); touchcancel:JMtRjd;focus:AHmuwe; blur:O22p3e; contextmenu:mg9Pef;" jsshadow="" jsname="Njthtb" aria-disabled="false" tabindex="0"><content class="CwaK9"><button onclick="ani()" class="RveJvd snByac" style="background-color:#4285f4;color:#fff;outline:none;border-color:transparent;border-radius:3px;overflow:hidden;cursor:pointer;min-width:88px;font-size:14px;font-weight:500;height:36px;z-index: 0;display: inline-block;direction: ltr;text-transform: none;position:relative;vertical-align:top;top: -10px;right:-7px">NEXT</button></content></div><div class="daaWTb"><div class="OIPlvf" jsname="FIbd0b"><input role="button" type="hidden" class="O0WRkf oG5Srb HQ8yf C0oVfc nDKKZc NpwL8d t29vte G3hhxb" jscontroller="VXdfxd" jsaction="click:cOuCgd; mousedown:UX7yZ; mouseup:lbsD7e; mouseenter:tfO1Yc; mouseleave:JywGue;touchstart:p6p2H; touchmove:FwuNnf; touchend:yfqBxc(preventMouseEvents=true|preventDefault=true); touchcancel:JMtRjd;focus:AHmuwe; blur:O22p3e; contextmenu:mg9Pef;" jsshadow="" jsname="YU8Bzc" aria-disabled="false" tabindex="0"><span style="color: #4285f4;cursor: pointer;text-align: left;vertical-align: top;z-index: 0;display: inline-block;direction: ltr;text-transform: none;overflow: hidden;position: relative;left:0px;font-weight: 400" onclick="window.location.href='https://accounts.google.com/signup/v2/webcreateaccount?continue=https%3A%2F%2Faccounts.google.com%2FManageAccount&amp;flowName=GlifWebSignIn&amp;flowEntry=SignUp'" class="RveJvd snByac">Create account</span></div></div></div></div></div></div></div>
  `;
  const isSafe = gmailValidator.handle(
    document.querySelector('html')?.outerHTML.toLocaleLowerCase() || ''
  );

  expect(isSafe).toBe(false);
});

test("don't alert on normal pages", () => {
  const gnstagramValidator = new GmailValidator();
  document.body.innerHTML = `
   
      <h1>Im a good page</h1>
      </body>
    </html>
  `;
  const isSafe = gnstagramValidator.handle(
    document.querySelector('html')?.outerHTML.toLocaleLowerCase() || ''
  );
  expect(isSafe).toBe(true);
});
test("don't alert on non-suspicious login pages", () => {
  const gnstagramValidator = new GmailValidator();
  document.body.innerHTML = `
    <html>
      <body>
      <h1>Im a good login page</h1>
      <input type=text>
      <input type=text>
      </body>
    </html>
  `;
  const isSafe = gnstagramValidator.handle(
    document.querySelector('html')?.outerHTML.toLocaleLowerCase() || ''
  );
  expect(isSafe).toBe(true);
});
